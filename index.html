<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥æ—¶è–ªèµ„è®¡ç®—ç³»ç»Ÿ</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Inter å­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- è‡ªå®šä¹‰ Tailwind é…ç½® -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    },
                    colors: {
                        'muted-purple': '#9d84b7',
                        'muted-teal': '#6ca9a1',
                        'muted-pink': '#c792a6',
                        'muted-amber': '#e6af7e'
                    }
                }
            }
        }
    </script>
    <style>
        /* ç‚¹å‡»æ¸…ç©ºæ—¶çš„å ä½ç¬¦æ ·å¼ */
        .auto-clear.placeholder::placeholder {
            color: #9ca3af; /* ç°è‰² */
            opacity: 1;
        }
        .auto-clear.placeholder {
            color: transparent; /* éšè—çœŸå®è¾“å…¥æ–‡å­—ï¼Œåªæ˜¾ç¤º placeholder */
        }
        /* æµ…è‰²æ¨¡å¼ä¸‹èšç„¦æ—¶æ–‡å­—é¢œè‰² */
        .auto-clear.placeholder:focus {
            color: #111827; /* gray.900 */
        }
        /* æ·±è‰²æ¨¡å¼ä¸‹èšç„¦æ—¶æ–‡å­—é¢œè‰² */
        .dark .auto-clear.placeholder:focus {
            color: #f3f4f6; /* gray.100 */
        }
            /* æ·±è‰²æ¨¡å¼ä¸‹ï¼Œåªè¯»è¾“å…¥æ¡†çš„èƒŒæ™¯è‰² */
        .dark input[readonly] {
        background-color: #374151; /* gray.700 */
        }
    </style>
</head>
<body class="h-screen bg-gradient-to-br from-purple-50 via-gray-50 to-purple-100 py-2 px-1 sm:px-2 md:px-4 font-sans antialiased transition-colors duration-300 overflow-hidden">

    <div class="max-w-6xl mx-auto h-full flex flex-col">
        <!-- å¯æ»šåŠ¨çš„å†…å®¹åŒºåŸŸ -->
        <div class="flex-1 overflow-y-auto space-y-2">

            <!-- åŸºç¡€ä¿¡æ¯å¡ç‰‡ -->
            <div class="bg-white rounded-xl shadow-lg p-2 border border-gray-100 dark:bg-black dark:border-gray-700 dark:text-gray-300">
                <h2 class="text-2xl font-semibold text-gray-800 mb-2 flex items-center justify-between dark:text-gray-300">
                    <div class="flex items-center">
                        <svg class="w-6 h-6 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                        </svg>
                        åŸºç¡€ä¿¡æ¯
                    </div>
                    <!-- å¤œé—´æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
                    <button id="theme-toggle" class="px-3 py-1 text-xs bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300 dark:focus:ring-purple-500">
                        <span id="theme-icon">ğŸŒ™</span>
                        <span id="theme-text">æµ…è‰²</span>
                    </button>
                </h2>
                <div class="space-y-2">
                    <div class="grid grid-cols-3 gap-2">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">åº•è–ª (å…ƒ)</label>
                            <input type="number" id="baseSalary" value="2600" onchange="calculate()" class="auto-clear w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">æ­£ç­å¤©æ•°</label>
                            <input type="number" id="regularDays" value="19" onchange="calculate()" class="auto-clear w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">å·¥ä»· (å…ƒ/å°æ—¶)</label>
                            <input type="number" id="workPrice" value="23" step="0.01" onchange="calculate()" class="auto-clear w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-2">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">æ—¶è–ª (å…ƒ/å°æ—¶)</label>
                            <input type="text" id="hourlyRate" readonly tabindex="-1" class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-200 cursor-not-allowed text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-black">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">æ€»å·¥æ—¶ (å°æ—¶)</label>
                            <input type="text" id="workHours" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-200 cursor-not-allowed text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-black">
                        </div>
                    </div>
                </div>
            </div>

            <!-- åŠ ç­ä¿¡æ¯å¡ç‰‡ -->
            <div class="bg-white rounded-xl shadow-lg p-2 border border-gray-100 dark:bg-black dark:border-gray-700 dark:text-gray-300">
                <h2 class="text-2xl font-semibold text-gray-800 mb-2 flex items-center dark:text-gray-300">
                    <svg class="w-6 h-6 mr-2 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    åŠ ç­ä¿¡æ¯
                </h2>
                <div class="space-y-2">
                    <div class="grid grid-cols-3 gap-2">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">G1 (å…ƒ/å°æ—¶)</label>
                            <input type="text" id="g1Rate" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-200 cursor-not-allowed text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-black">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">å·¥æ—¶ (å°æ—¶)</label>
                            <input type="number" id="g1Hours" value="40" onchange="calculate()" class="auto-clear w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">è–ªèµ„ (å…ƒ)</label>
                            <input type="text" id="g1Pay" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-200 cursor-not-allowed text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-black">
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-2">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">G2 (å…ƒ/å°æ—¶)</label>
                            <input type="text" id="g2Rate" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-200 cursor-not-allowed text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-black">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">å·¥æ—¶ (å°æ—¶)</label>
                            <input type="number" id="g2Hours" value="40" onchange="calculate()" class="auto-clear w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">è–ªèµ„ (å…ƒ)</label>
                            <input type="text" id="g2Pay" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-200 cursor-not-allowed text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-black">
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-2">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">G3 (å…ƒ/å°æ—¶)</label>
                            <input type="text" id="g3Rate" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-200 cursor-not-allowed text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-black">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">å·¥æ—¶ (å°æ—¶)</label>
                            <input type="number" id="g3Hours" value="0" onchange="calculate()" class="auto-clear w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 truncate dark:text-gray-400">è–ªèµ„ (å…ƒ)</label>
                            <input type="text" id="g3Pay" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-200 cursor-not-allowed text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-black">
                        </div>
                    </div>
                </div>
            </div>

            <!-- è®¡ç®—ç»“æœå¡ç‰‡ -->
            <div class="bg-white rounded-xl shadow-lg p-2 border border-gray-100 dark:bg-black dark:border-gray-700 dark:text-gray-300">
                <h2 class="text-2xl font-semibold text-gray-800 mb-2 flex items-center dark:text-gray-300">
                    <svg class="w-6 h-6 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    è®¡ç®—ç»“æœ
                </h2>
                <div class="space-y-2">
                    <div class="bg-purple-50 rounded-lg p-2 border-l-4 border-purple-500 dark:bg-gray-800 dark:border-purple-500">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium dark:text-gray-400">åŠ ç­è–ªèµ„</span>
                            <span class="text-lg sm:text-xl md:text-2xl font-bold text-purple-600 dark:text-purple-400" id="overtimePay">0 å…ƒ</span>
                        </div>
                    </div>
                    <div class="bg-emerald-50 rounded-lg p-2 border-l-4 border-emerald-500 dark:bg-gray-800 dark:border-emerald-500">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium dark:text-gray-400">æ€»è®¡ (åº•è–ª+åŠ ç­)</span>
                            <span class="text-lg sm:text-xl md:text-2xl font-bold text-emerald-600 dark:text-emerald-400" id="totalPay">0 å…ƒ</span>
                        </div>
                    </div>
                    <div class="bg-violet-50 rounded-lg p-2 border-l-4 border-violet-500 dark:bg-gray-800 dark:border-violet-500">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium dark:text-gray-400">å°æ—¶å·¥è–ªèµ„</span>
                            <span class="text-lg sm:text-xl md:text-2xl font-bold text-violet-600 dark:text-violet-400" id="workSalary">0 å…ƒ</span>
                        </div>
                    </div>
                    <!-- åŠ G3è–ªèµ„åŒºåŸŸ - æ ¹æ®G3å·¥æ—¶æ˜¯å¦ä¸º0å†³å®šæ˜¯å¦æ˜¾ç¤º -->
                    <div id="g3Section" class="bg-amber-50 rounded-lg p-2 border-l-4 border-amber-500 dark:bg-gray-800 dark:border-amber-500">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium dark:text-gray-400">åŠ G3è–ªèµ„</span>
                            <span class="text-lg sm:text-xl md:text-2xl font-bold text-amber-600 dark:text-amber-400" id="totalWithG3">0 å…ƒ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript é€»è¾‘ -->
    <script>
        let formData = {
            baseSalary: 0,
            regularDays: 0,
            g1Hours: 0,
            g2Hours: 0,
            g3Hours: 0,
            hourlyRate: 0,
            g1Rate: 0,
            g2Rate: 0,
            g3Rate: 0,
            workHours: 0,
            workPrice: 0,
            subsidy: 0
        };

        let results = {
            overtimePay: 0,
            totalPay: 0,
            workSalary: 0,
            totalWithG3: 0
        };

        const STORAGE_KEY = 'salaryCalculatorData';

        // æ£€æŸ¥ç³»ç»Ÿåå¥½å’Œæœ¬åœ°å­˜å‚¨çš„ç”¨æˆ·è®¾ç½®
        function getThemePreference() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme !== null) {
                return savedTheme;
            }
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        // åº”ç”¨ä¸»é¢˜
        function applyTheme(theme) {
            const body = document.body;
            const toggleButton = document.getElementById('theme-toggle');
            const icon = document.getElementById('theme-icon');
            const text = document.getElementById('theme-text');

            if (theme === 'dark') {
                body.classList.add('dark');
                body.classList.add('bg-gray-900', 'text-gray-300');
                body.classList.remove('bg-gradient-to-br', 'from-purple-50', 'via-gray-50', 'to-purple-100');
                toggleButton.classList.replace('bg-gray-200', 'bg-gray-700');
                toggleButton.classList.replace('text-gray-800', 'text-gray-300');
                icon.textContent = 'â˜€ï¸';
                text.textContent = 'æ·±è‰²';
            } else {
                body.classList.remove('dark');
                body.classList.add('bg-gradient-to-br', 'from-purple-50', 'via-gray-50', 'to-purple-100');
                body.classList.remove('bg-gray-900', 'text-gray-300');
                toggleButton.classList.replace('bg-gray-700', 'bg-gray-200');
                toggleButton.classList.replace('text-gray-300', 'text-gray-800');
                icon.textContent = 'ğŸŒ™';
                text.textContent = 'æµ…è‰²';
            }
            localStorage.setItem('theme', theme);
        }

        // åˆå§‹åŒ–ä¸»é¢˜
        function initTheme() {
            const theme = getThemePreference();
            applyTheme(theme);
        }

        // åˆ‡æ¢ä¸»é¢˜
        function toggleTheme() {
            const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            applyTheme(newTheme);
        }

        // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (!localStorage.getItem('theme')) {
                applyTheme(e.matches ? 'dark' : 'light');
            }
        });

        function saveData() {
            try {
                const dataToSave = { formData, timestamp: new Date().toISOString() };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
            } catch (error) {
                console.error('ä¿å­˜æ•°æ®å¤±è´¥:', error);
            }
        }

        function loadData() {
            try {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    if (parsedData.formData) {
                        Object.assign(formData, parsedData.formData);
                        return true;
                    }
                }
            } catch (error) {
                console.error('è¯»å–æ•°æ®å¤±è´¥:', error);
            }
            return false;
        }

        function calculate() {
            formData.baseSalary = parseFloat(document.getElementById('baseSalary').value) || 0;
            formData.regularDays = parseFloat(document.getElementById('regularDays').value) || 0;
            formData.g1Hours = parseFloat(document.getElementById('g1Hours').value) || 0;
            formData.g2Hours = parseFloat(document.getElementById('g2Hours').value) || 0;
            formData.g3Hours = parseFloat(document.getElementById('g3Hours').value) || 0;
            formData.workPrice = parseFloat(document.getElementById('workPrice').value) || 0;

            formData.hourlyRate = formData.baseSalary / (21.75 * 8);
            document.getElementById('hourlyRate').value = formData.hourlyRate.toFixed(2);

            formData.g1Rate = formData.hourlyRate * 1.5;
            document.getElementById('g1Rate').value = formData.g1Rate.toFixed(2);

            formData.g2Rate = formData.hourlyRate * 2;
            document.getElementById('g2Rate').value = formData.g2Rate.toFixed(2);

            formData.g3Rate = formData.hourlyRate * 3;
            document.getElementById('g3Rate').value = formData.g3Rate.toFixed(2);

            formData.workHours = formData.regularDays * 8 + formData.g1Hours + formData.g2Hours;
            document.getElementById('workHours').value = formData.workHours;

            const g1Pay = formData.g1Hours * formData.g1Rate;
            const g2Pay = formData.g2Hours * formData.g2Rate;
            const g3Pay = formData.g3Hours * formData.g3Rate;

            document.getElementById('g1Pay').value = g1Pay.toFixed(2);
            document.getElementById('g2Pay').value = g2Pay.toFixed(2);
            document.getElementById('g3Pay').value = g3Pay.toFixed(2);

            results.overtimePay = g1Pay + g2Pay + g3Pay;
            results.totalPay = formData.baseSalary / 21.75 * formData.regularDays + results.overtimePay;
            results.workSalary = (formData.workHours * formData.workPrice) + formData.subsidy;
            results.totalWithG3 = results.workSalary + g3Pay;

            document.getElementById('overtimePay').textContent = results.overtimePay.toFixed(2) + ' å…ƒ';
            document.getElementById('totalPay').textContent = results.totalPay.toFixed(2) + ' å…ƒ';
            document.getElementById('workSalary').textContent = results.workSalary.toFixed(2) + ' å…ƒ';
            document.getElementById('totalWithG3').textContent = results.totalWithG3.toFixed(2) + ' å…ƒ';

            // æ ¹æ®G3å·¥æ—¶æ˜¯å¦ä¸º0æ¥æ˜¾ç¤ºæˆ–éšè—åŠ G3è–ªèµ„éƒ¨åˆ†
            const g3Section = document.getElementById('g3Section');
            if (formData.g3Hours === 0) {
                g3Section.style.display = 'none';
            } else {
                g3Section.style.display = 'block';
            }

            saveData();
        }

        // âœ… è‡ªåŠ¨æ¸…ç©º + æ¢å¤åŸå€¼é€»è¾‘
        function setupAutoClear() {
            document.querySelectorAll('.auto-clear').forEach(input => {
                input.dataset.originalValue = input.value;

                input.addEventListener('focus', function() {
                    if (this.value === this.dataset.originalValue) {
                        this.value = '';
                        this.classList.add('placeholder');
                        this.placeholder = this.dataset.originalValue;
                    }
                });

                input.addEventListener('blur', function() {
                    if (this.value.trim() === '') {
                        this.value = this.dataset.originalValue;
                        this.classList.remove('placeholder');
                        this.placeholder = '';
                    } else {
                        this.dataset.originalValue = this.value;
                        this.classList.remove('placeholder');
                        this.placeholder = '';
                    }
                });
            });
        }

        window.onload = function() {
            initTheme();

            // ä»é¡µé¢ input è¯»å–åˆå§‹å€¼
            formData.baseSalary = parseFloat(document.getElementById('baseSalary').value) || 0;
            formData.regularDays = parseFloat(document.getElementById('regularDays').value) || 0;
            formData.g1Hours = parseFloat(document.getElementById('g1Hours').value) || 0;
            formData.g2Hours = parseFloat(document.getElementById('g2Hours').value) || 0;
            formData.g3Hours = parseFloat(document.getElementById('g3Hours').value) || 0;
            formData.workPrice = parseFloat(document.getElementById('workPrice').value) || 0;

            // å°è¯•ä» localStorage åŠ è½½
            const dataLoaded = loadData();
            if (dataLoaded) {
                document.getElementById('baseSalary').value = formData.baseSalary;
                document.getElementById('regularDays').value = formData.regularDays;
                document.getElementById('g1Hours').value = formData.g1Hours;
                document.getElementById('g2Hours').value = formData.g2Hours;
                document.getElementById('g3Hours').value = formData.g3Hours;
                document.getElementById('workPrice').value = formData.workPrice;
            } else {
                console.log('æœªæ‰¾åˆ°ä¿å­˜çš„æ•°æ®ï¼Œä½¿ç”¨é¡µé¢é»˜è®¤å€¼');
            }

            calculate();
            setupAutoClear();
        };

        document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
        window.addEventListener('beforeunload', saveData);
    </script>
</body>
</html>
