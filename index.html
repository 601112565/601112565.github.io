<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    
    <!-- 响应式设计 viewport 设置，确保在移动设备上正确显示 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- 页面标题 -->
    <title>工时薪资计算系统</title>
    
    <!-- 引入 Tailwind CSS 框架，用于快速构建现代化的用户界面 -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 自定义CSS样式 -->
    <style>
        /* 引入 Google Fonts 的 Inter 字体 */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        /* 设置页面整体字体为 Inter */
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-3 px-2">
    <!-- 页面主体，设置最小高度为屏幕高度，背景为蓝色渐变，内边距为8和4 -->
    
    <!-- 最大宽度容器，居中显示，最大宽度为6xl -->
    <div class="max-w-6xl mx-auto">
        
        <!-- 标题区域，文字居中，下边距为8 -->
        <div class="text-center mb-3">
            <!-- 主标题，4xl大小，粗体，深灰色，下边距2 -->
            <h1 class="text-4xl font-bold text-gray-800 mb-2">工时薪资计算系统</h1>
            <!-- 副标题，灰色 -->
            <p class="text-gray-600">精准计算您的薪资与加班费用</p>
        </div>
        
        <!-- 基础薪资信息卡片 -->
        <div class="bg-white rounded-xl shadow-lg p-3 mb-3">
            <!-- 标题，包含图标 -->
            <h2 class="text-2xl font-semibold text-gray-800 mb-3 flex items-center">
                <svg class="w-6 h-6 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                   <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                </svg>
                 基础薪资信息
            </h2>
            <!-- 表单内容 -->
            <div class="space-y-4">
                <!-- 底薪和正班天数输入行 -->
                <div class="grid grid-cols-3 gap-2">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">底薪 (元)</label>
                        <!-- 底薪输入框，初始值2600，值改变时调用calculate函数 -->
                        <input type="number" id="baseSalary" value="2600" onchange="calculate()" class="w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">正班天数</label>
                        <!-- 正班天数输入框，初始值22，值改变时调用calculate函数 -->
                        <input type="number" id="regularDays" value="19" onchange="calculate()" class="w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">工价 (元/小时)</label>
                        <!-- 工价输入 -->
                        <input type="number" id="workPrice" value="23" step="0.01" onchange="calculate()" class="w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
                <!-- 时薪和总工时行数 -->
                <div class="grid grid-cols-3 gap-2">
                    <!-- 时薪显示 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">时薪 (元/小时)</label>
                        <!-- 时薪显示框，只读 -->
                        <input type="text" id="hourlyRate" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">总工时 (小时)</label>
                        <!-- 总工时输入 -->
                        <input type="text" id="workHours" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                    </div>
                </div>
            </div>
        </div>

        <!-- 加班信息卡片 -->
        <div class="bg-white rounded-xl shadow-lg p-3 mb-3">
            <!-- 标题，包含图标 -->
            <h2 class="text-2xl font-semibold text-gray-800 mb-3 flex items-center">
                <svg class="w-6 h-6 mr-2 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                加班信息
            </h2>
            <!-- 加班信息表格 -->
            <div class="space-y-4">
                <!-- G1加班行 -->
                <div class="grid grid-cols-3 gap-2">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">G1 (元/小时)</label>
                        <!-- G1加班费率输入 -->
                        <input type="text" id="g1Rate" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">工时 (小时)</label>
                        <!-- G1加班工时输入 -->
                        <input type="number" id="g1Hours" value="40" onchange="calculate()" class="w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">薪资 (元)</label>
                        <!-- G1加班薪资显示 -->
                        <input type="text" id="g1Pay" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                    </div>
                </div>
                <!-- G2加班行 -->
                <div class="grid grid-cols-3 gap-2">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">G2 (元/小时)</label>
                        <!-- G2加班费率输入 -->
                        <input type="text" id="g2Rate" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">工时 (小时)</label>
                        <!-- G2加班工时输入 -->
                        <input type="number" id="g2Hours" value="40" onchange="calculate()" class="w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">薪资 (元)</label>
                        <!-- G2加班薪资显示 -->
                        <input type="text" id="g2Pay" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                    </div>
                </div>
                <!-- G3加班行 -->
                <div class="grid grid-cols-3 gap-2">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">G3 (元/小时)</label>
                        <!-- G3加班费率输入 -->
                        <input type="text" id="g3Rate" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">工时 (小时)</label>
                        <!-- G3加班工时输入 -->
                        <input type="number" id="g3Hours" value="0" onchange="calculate()" class="w-full px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">薪资 (元)</label>
                        <!-- G3加班薪资显示 -->
                        <input type="text" id="g3Pay" readonly class="w-full px-3 py-1 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                    </div>
                </div>
            </div>
        </div>

        <!-- 计算结果内容区域 -->
        <div class="bg-white rounded-xl shadow-lg p-3">
            <!-- 计算结果卡片 -->
            <div class="bg-white rounded-xl p-3">
                <!-- 标题，包含图标 -->
                <h2 class="text-2xl font-semibold text-gray-800 mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    计算结果
                </h2>
                <!-- 结果显示区域 -->
                <div class="space-y-4">
                    <!-- 加班薪资显示 -->
                    <div class="bg-blue-50 rounded-lg p-2 border-l-4 border-blue-500">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">加班薪资</span>
                            <span class="text-2xl font-bold text-blue-600" id="overtimePay">0 元</span>
                        </div>
                    </div>
                    <!-- 总计显示 -->
                    <div class="bg-green-50 rounded-lg p-2 border-l-4 border-green-500">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">总计 (底薪+加班)</span>
                            <span class="text-2xl font-bold text-green-600" id="totalPay">0 元</span>
                        </div>
                    </div>
                    <!-- 工时工资显示 -->
                    <div class="bg-purple-50 rounded-lg p-2 border-l-4 border-purple-500">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">小时工薪资</span>
                            <span class="text-2xl font-bold text-purple-600" id="workSalary">0 元</span>
                        </div>
                    </div>
                    <!-- 加G3薪资显示 -->
                    <div class="bg-orange-50 rounded-lg p-2 border-l-4 border-orange-500">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">加G3薪资</span>
                            <span class="text-2xl font-bold text-orange-600" id="totalWithG3">0 元</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 统计图表卡片 -->
            <div class="bg-white rounded-xl p-3 mt-3">
                <!-- 标题 -->
                <h2 class="text-2xl font-semibold text-gray-800 mb-3">薪资构成分析</h2>
                <!-- 进度条图表 -->
                <div class="space-y-4">
                    <!-- 底薪占比 -->
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span>底薪</span>
                            <span id="basePercent">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="baseBar" class="bg-blue-500 h-3 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <!-- G1加班占比 -->
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span>G1 加班</span>
                            <span id="g1Percent">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="g1Bar" class="bg-green-500 h-3 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <!-- G2加班占比 -->
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span>G2 加班</span>
                            <span id="g2Percent">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="g2Bar" class="bg-purple-500 h-3 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <!-- G3加班占比 -->
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span>G3 加班</span>
                            <span id="g3Percent">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="g3Bar" class="bg-orange-500 h-3 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript 代码 -->
    <script>
        // 初始化数据对象，存储所有表单数据
        let formData = {
            baseSalary: 2600,        // 底薪
            regularDays: 22,         // 正班天数
            totalHours: 256,         // 总工时
            g1Hours: 40,             // G1加班工时
            g2Hours: 40,             // G2加班工时
            g3Hours: 0,              // G3加班工时
            hourlyRate: 0,           // 时薪
            g1Rate: 0,               // G1加班费率
            g2Rate: 0,               // G2加班费率
            g3Rate: 0,               // G3加班费率
            workHours: 0,            // 工时
            workPrice: 23,           // 工价
            subsidy: 0               // 补贴
        };

        // 结果数据对象，存储计算结果
        let results = {
            overtimePay: 0,          // 加班薪资
            totalPay: 0,             // 总计
            workSalary: 0,           // 工时工资
            totalWithG3: 0           // 加G3工资
        };
        
        // 存储键名
        const STORAGE_KEY = 'salaryCalculatorData';

        // 保存数据到 localStorage
        function saveData() {
            try {
                const dataToSave = {
                    formData: formData,
                    timestamp: new Date().toISOString()
                };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
                console.log('数据已保存到本地存储');
            } catch (error) {
                console.error('保存数据失败:', error);
            }
        }

        // 从 localStorage 读取数据
        function loadData() {
            try {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    if (parsedData.formData) {
                        // 更新 formData 对象
                        Object.assign(formData, parsedData.formData);
                        console.log('已从本地存储加载数据');
                        return true;
                    }
                }
            } catch (error) {
                console.error('读取数据失败:', error);
            }
            return false;
        }

        // 切换标签页函数（现在不需要，但保留以防将来需要）
        function switchTab(tabName) {
            // 现在是单页面布局，不需要切换
            console.log('当前标签页:', tabName);
        }

        // 计算函数
        function calculate() {
            // 获取表单数据并转换为数字
            formData.baseSalary = parseFloat(document.getElementById('baseSalary').value) || 0;
            formData.regularDays = parseFloat(document.getElementById('regularDays').value) || 0;
            formData.g1Hours = parseFloat(document.getElementById('g1Hours').value) || 0;
            formData.g2Hours = parseFloat(document.getElementById('g2Hours').value) || 0;
            formData.g3Hours = parseFloat(document.getElementById('g3Hours').value) || 0;
            formData.workPrice = parseFloat(document.getElementById('workPrice').value) || 0;

            // 计算时薪：底薪 / (21.75 * 8小时)
            formData.hourlyRate = formData.baseSalary / (21.75 * 8);
            // 显示时薪，保留两位小数
            document.getElementById('hourlyRate').value = formData.hourlyRate.toFixed(2);
            
            // g1
            formData.g1Rate = formData.hourlyRate * 1.5;
            document.getElementById('g1Rate').value = formData.g1Rate.toFixed(2);
            
            // g2
            formData.g2Rate = formData.hourlyRate * 2;
            document.getElementById('g2Rate').value = formData.g2Rate.toFixed(2);
            
            // g3
            formData.g3Rate = formData.hourlyRate * 3;
            document.getElementById('g3Rate').value = formData.g3Rate.toFixed(2);
            
            // 计算总工时
            formData.workHours = formData.regularDays * 8 + formData.g1Hours + formData.g2Hours;
            document.getElementById('workHours').value = formData.workHours;

            // 计算各项加班薪资
            const g1Pay = formData.g1Hours * formData.g1Rate;
            const g2Pay = formData.g2Hours * formData.g2Rate;
            const g3Pay = formData.g3Hours * formData.g3Rate;
            
            // 显示各项加班薪资
            document.getElementById('g1Pay').value = g1Pay.toFixed(2);
            document.getElementById('g2Pay').value = g2Pay.toFixed(2);
            document.getElementById('g3Pay').value = g3Pay.toFixed(2);

            // 计算总加班薪资
            results.overtimePay = g1Pay + g2Pay + g3Pay;
            // 计算总计：底薪 + 加班薪资
            results.totalPay = formData.baseSalary + results.overtimePay;
            // 计算工时工资：工时 * 工价 + 补贴
            results.workSalary = (formData.workHours * formData.workPrice) + formData.subsidy;
            // 计算加G3工资：工时工资 + G3加班薪资
            results.totalWithG3 = results.workSalary + g3Pay;

            // 更新结果显示
            document.getElementById('overtimePay').textContent = results.overtimePay.toFixed(2) + ' 元';
            document.getElementById('totalPay').textContent = results.totalPay.toFixed(2) + ' 元';
            document.getElementById('workSalary').textContent = results.workSalary.toFixed(2) + ' 元';
            document.getElementById('totalWithG3').textContent = results.totalWithG3.toFixed(2) + ' 元';

            // 更新图表
            const total = results.totalPay;
            if (total > 0) {
                // 计算各项占比并更新显示
                document.getElementById('basePercent').textContent = ((formData.baseSalary / total) * 100).toFixed(1) + '%';
                document.getElementById('g1Percent').textContent = ((g1Pay / total) * 100).toFixed(1) + '%';
                document.getElementById('g2Percent').textContent = ((g2Pay / total) * 100).toFixed(1) + '%';
                document.getElementById('g3Percent').textContent = ((g3Pay / total) * 100).toFixed(1) + '%';
                
                // 更新进度条宽度
                document.getElementById('baseBar').style.width = (formData.baseSalary / total) * 100 + '%';
                document.getElementById('g1Bar').style.width = (g1Pay / total) * 100 + '%';
                document.getElementById('g2Bar').style.width = (g2Pay / total) * 100 + '%';
                document.getElementById('g3Bar').style.width = (g3Pay / total) * 100 + '%';
            }
            
            // 保存数据到 localStorage
            saveData();
        }

        // 页面加载完成后执行的函数
        window.onload = function() {
            // 尝试从 localStorage 加载数据
            const dataLoaded = loadData();
            
            // 如果没有保存的数据，使用默认值
            if (!dataLoaded) {
                console.log('未找到保存的数据，使用默认值');
            }
            
            // 填充表单字段
            document.getElementById('baseSalary').value = formData.baseSalary;
            document.getElementById('regularDays').value = formData.regularDays;
            document.getElementById('g1Hours').value = formData.g1Hours;
            document.getElementById('g2Hours').value = formData.g2Hours;
            document.getElementById('g3Hours').value = formData.g3Hours;
            document.getElementById('workPrice').value = formData.workPrice;

            // 执行一次计算，初始化数据显示
            calculate();
        };

        // 监听窗口卸载事件，确保数据被保存
        window.addEventListener('beforeunload', function() {
            saveData();
        });
    </script>
</body>
</html>